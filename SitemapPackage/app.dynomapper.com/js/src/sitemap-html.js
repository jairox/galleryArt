!function(a){"use strict";function b(a,b,c,d){function e(){for(var g=c;g--&&f<a.length;)b.call(d,a[f],f,a),++f;f<a.length&&setTimeout(e,1),f>=a.length&&b.call(d,null,f,a)}d=d||window,c=c||100;var f=0;e()}function c(b){k.empty(),_.each(b,function(b){var c=a(o(b));c.data("item",b),k.append(c)}),k.find(".item-link").click(function(){var b=a(this).parent(),c=b.data("item");return f.trigger("loadItems",[b,c]),!1})}function d(a){b(g,function(b){if(!b)return void a();m[b.id]=b;var c=b.parent_id?b.parent_id:"#";_.isUndefined(l[c])&&(l[c]=[]),l[c].push(b)},500)}function e(){var b=a("#header .page-logo"),c=b.position(),d=c.top+b.outerHeight(),e=a("#mainbody").css({top:d+"px"});if("tree"===h||"circle"===h){var f=e.position(),g=a(window).height();e.css("height",g-f.top-20)}}var f,g,h,i,j,k,l={},m={},n={},o=_.template('<li class="item"><a class="item-link" href="javascript:;" title="<%= title %>" data-id="<%= id %>"><i class="glyph-icon">&#10095;</i> <%= title %></a></li>');window.sitemapInit=function(b){a(function(){g=b,f=a("#sitemap-wrap"),h=f.data("style"),i=parseInt(f.data("max-level"))-1,j=f.data("colors"),k=a("#header .breadcrumbs"),e(),d(function(){n[h]()})})},n["default"]=function(){function b(m,n,o){if(!(n>i)){0===n&&o.empty();var p=e.clone();_.each(_.isArray(m)?m:[m],function(e){var m=g.clone();m.attr("id","leaf"+e.id),m.data("item",e);var o=_.extend({prev:!1,next:!1,classname:""},e),q=l[e.id];if(q&&n===i&&(o.next=!0),d.id===e.id&&k.length>1&&(o.prev=!0),j.length){var r=n-Math.floor(n/j.length)*j.length;o.classname="l"+r+"bg"}m.append(h(o)),p.append(m),m.find(".btn-nav .btn.nx").click(function(){var e=a(this).parents(".leaf:first"),g=e.data("item");d=g,k.push(g),c(k),b(g,0,f),window.scrollTo(0,0)}),m.find(".btn-nav .btn.pv").click(function(){k.pop();var a=k[k.length-1];d=a,c(k),b(a,0,f),window.scrollTo(0,0)}),q&&setTimeout(function(){b(q,n+1,m)})}),o.append(p)}}var d,e=a('<ul class="branch">'),g=a('<li class="leaf">'),h=_.template('<div class="bx"><div class="bx2 <%= classname %>">        <% if(prev){ %>        <div class="btn-nav top">        <a href="javascript:;" class="pv btn small"><i class="glyph-icon icon-arrow-up"></i></a>        </div>        <% } %>        <h4><%= title %></h4>        <% if(typeof(url) != "undefined" && !_.isEmpty(url)){ %>        <p><a href="<%= url %>" target="_blank"><%= url %></a></p>        <% } %>        <% if(next){ %>        <div class="btn-nav">        <a href="javascript:;" class="nx btn small"><i class="glyph-icon icon-arrow-down"></i></a>        </div>        <% } %>        </div></div>'),k=[];_.each(l["#"],function(a){d=a,k.push(a),c(k),b(a,0,f)}),f.on("loadItems",function(a,e,g){d.id!==g.id&&(k=k.slice(0,e.index()+1),d=g,c(k),b(g,0,f))})},n.tree=function(){function a(e,f){if(f>i)return d.refreshVisualization(),d.open(b.id),void d.focus(b.id);var g=!1;_.each(_.isArray(e)?e:[e],function(b){var e=l[b.id];if(!_.isEmpty(d.getNode(b.id)))return void(e&&setTimeout(function(){a(e,f+1)},1));e&&f===i&&(b["data-next"]=1),j.length&&(b["data-depth"]=f-Math.floor(f/j.length)*j.length),e&&(b["data-isparent"]=1);var h=b.title;h.length>c&&(h=h.substr(0,c)+"..."),d.addNodeQueue(b.parent_id,b.id,h,b),e&&(g=!0,setTimeout(function(){a(e,f+1)},1))}),g||(d.refreshVisualization(),d.open(b.id),d.focus(b.id))}var b,c=20,d=f.treeLayout();d.treeNodeRadius(8),d.treeLineHeight(35),d.treeNodeOuterRadius(10),d.on("d3click",function(c,d){var e=d.data;!d.loaded&&e["data-next"]&&(b=e,a(e,0),d.loaded=!0)}),_.each(l["#"],function(c){b=c,a(c,0)})},n.circle=function(){function a(b,c){if(c>i)return e.refreshVisualization(),g=!0,e.focus(d.id),void(g=!1);var f=!1;_.each(_.isArray(b)?b:[b],function(b){var d=l[b.id];return _.isEmpty(e.getNode(b.id))?(d&&c===i&&(b["data-next"]=1),j.length&&(b["data-depth"]=c-Math.floor(c/j.length)*j.length),d&&(b["data-isparent"]=1),e.addNodeQueue(b.parent_id,b.id,b.title,b),void(d&&(f=!0,setTimeout(function(){a(d,c+1)},1)))):void(d&&setTimeout(function(){a(d,c+1)},1))}),f||(e.refreshVisualization(),g=!0,e.focus(d.id),g=!1)}function b(a){var b=a,c=[];do c.push(b),b=b.parent_id&&m[b.parent_id]?m[b.parent_id]:null;while(b);return c.reverse()}f.addClass("style-circle");var d,e=f.circleLayout(),g=!1,h=[];e.on("d3focus",function(e,f){var i=f.data;d=i,g||(h=b(i),c(h),!f.loaded&&i["data-next"]&&(d=i,a(i,0),f.loaded=!0))}),_.each(l["#"],function(e){d=e,h=b(e),c(h),a(e,0)}),f.on("loadItems",function(a,b,f){d.id!==f.id&&(h=h.slice(0,b.index()+1),d=f,c(h),g=!0,e.focus(f.id),g=!1)})},n.folder=function(){function b(a,b){var c=!1,d=!1,e=k,f=l[a.id];f&&(c=!0,e=n);var g="";j.length&&(g=b-Math.floor(b/j.length)*j.length);var h={id:a.id,parent:a.parent_id||"#",text:a.title,icon:e,state:{opened:c,selected:d,disabled:!1},data:a,li_attr:{},a_attr:{"class":"level"+g,"data-depth":b}};return f&&b==i&&(h.children=!0,h.state.opened=!1),h}function d(a,c){function d(a,c){_.each(_.isArray(a)?a:[a],function(a){var f=b(a,c);if(e.push(f),f.state.opened){var g=l[a.id];d(g,c+1)}})}var e=[];_.each(l[a],function(a){d(a,0)}),c(e),"#"==a&&setTimeout(function(){h.select_node(e[0].id)},10)}function e(a){var b=a,c=[];do c.push(b),b=b.parent_id&&m[b.parent_id]?m[b.parent_id]:null;while(b);return c.reverse()}var g,h,k="glyph-icon icon-file font-size-20",n="glyph-icon icon-folder-close font-size-20",o=a("<div>"),p=[];f.html(o),o.jstree({core:{themes:{variant:"large"},check_callback:function(){return!0},data:function(a,b){return"#"==a.id?void d(a.id,b):void d(a.id,b)},multiple:!1}}),o.on("select_node.jstree",function(a,b){g&&g.id==b.node.id||(p=e(m[b.node.id]),c(p)),g=b.node}),h=o.jstree(!0),f.on("loadItems",function(a,b,d){g.id!==d.id&&(p=p.slice(0,b.index()+1),c(p),h.deselect_all(),h.select_node(d.id))})},a(window).load(function(){e()})}(jQuery);